<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>

    <div class="header-img position-absolute z-0 top-0 w-100 h-auto">

    <div class="d-flex align-items-center justify-content-center m-5 z-3  position-relative flex-column">
      <img src="img/f1.png" class="img-fluid f1-logo">
      <h1 class="header main-font text-white txt-shadow">TOP 10 F1</h1>
    </div>

    <div class="container z-3  position-relative shadow-sm">
      <div class="row pointList">
		</div>

    
	</div>	
  <div class="container-fluid mt-5">
    <div class="row align-items-center flex-row flex-nowrap overflow-x-auto">
      <div class="col-md-2 darkcolor justify-content-center py-5 coleffect coleffectborder">
        <img src="img/sa.png" class="img-fluid mx-auto d-block" alt="..."> 
        <p class="text-center main-font font-weight-900 lh-1 text-uppercase">saudi arabia</p>
        <h1 class="text-center main-font font-weight-900 lh-1 text-white">19</h1>
        <p class="text-center main-font font-weight-900 lh-1 text-white text-uppercase pb-5">MAR</p>
      </div>
  
      <div class="col-md-2 darkcolor justify-content-center py-5 coleffect coleffectborder">
        <img src="img/australia.png" class="img-fluid mx-auto d-block" alt="...">
        <p class="text-center main-font font-weight-900 lh-1 text-uppercase">australia</p>
        <h1 class="text-center main-font font-weight-900 lh-1 text-white">02</h1>
        <p class="text-center main-font font-weight-900 lh-1 text-white text-uppercase pb-5">apr</p>
      </div>
  
      <div class="col-md-2 darkcolor justify-content-center py-5 coleffect coleffectborder">
        <img src="img/azerbaijan.png" class="img-fluid mx-auto d-block" alt="...">
        <p class="text-center main-font font-weight-900 lh-1 text-uppercase">azerbijan</p>
        <h1 class="text-center main-font font-weight-900 lh-1 text-white">30</h1>
        <p class="text-center main-font font-weight-900 lh-1 text-white text-uppercase pb-5">apr</p>
      </div>
  
      <div class="col-md-2 darkcolor justify-content-center py-5 coleffect coleffectborder">
        <img src="img/sa.png" class="img-fluid mx-auto d-block" alt="..."> 
        <p class="text-center main-font font-weight-900 lh-1 text-uppercase">saudi arabia</p>
        <h1 class="text-center main-font font-weight-900 lh-1 text-white">19</h1>
        <p class="text-center main-font font-weight-900 lh-1 text-white text-uppercase pb-5">MAR</p>
      </div>
  
      <div class="col-md-2 darkcolor justify-content-center py-5 coleffect coleffectborder">
        <img src="img/australia.png" class="img-fluid mx-auto d-block" alt="...">
        <p class="text-center main-font font-weight-900 lh-1 text-uppercase">australia</p>
        <h1 class="text-center main-font font-weight-900 lh-1 text-white">02</h1>
        <p class="text-center main-font font-weight-900 lh-1 text-white text-uppercase pb-5">apr</p>
      </div>
  
      <div class="col-md-2 darkcolor justify-content-center py-5 coleffect coleffectborder">
        <img src="img/azerbaijan.png" class="img-fluid mx-auto d-block" alt="...">
        <p class="text-center main-font font-weight-900 lh-1 text-uppercase">azerbijan</p>
        <h1 class="text-center main-font font-weight-900 lh-1 text-white">30</h1>
        <p class="text-center main-font font-weight-900 lh-1 text-white text-uppercase pb-5">apr</p>
      </div>
  
      <div class="col-md-2 darkcolor justify-content-center py-5 coleffect coleffectborder">
        <img src="img/sa.png" class="img-fluid mx-auto d-block" alt="..."> 
        <p class="text-center main-font font-weight-900 lh-1 text-uppercase">saudi arabia</p>
        <h1 class="text-center main-font font-weight-900 lh-1 text-white">19</h1>
        <p class="text-center main-font font-weight-900 lh-1 text-white text-uppercase pb-5">MAR</p>
      </div>
  
      <div class="col-md-2 darkcolor justify-content-center py-5 coleffect coleffectborder">
        <img src="img/australia.png" class="img-fluid mx-auto d-block" alt="...">
        <p class="text-center main-font font-weight-900 lh-1 text-uppercase">australia</p>
        <h1 class="text-center main-font font-weight-900 lh-1 text-white">02</h1>
        <p class="text-center main-font font-weight-900 lh-1 text-white text-uppercase pb-5">apr</p>
      </div>
  
      <div class="col-md-2 darkcolor justify-content-center py-5 coleffect coleffectborder">
        <img src="img/azerbaijan.png" class="img-fluid mx-auto d-block" alt="...">
        <p class="text-center main-font font-weight-900 lh-1 text-uppercase">azerbijan</p>
        <h1 class="text-center main-font font-weight-900 lh-1 text-white">30</h1>
        <p class="text-center main-font font-weight-900 lh-1 text-white text-uppercase pb-5">apr</p>
      </div>
      
      <div class="col-md-2 darkcolor justify-content-center py-5 coleffect coleffectborder">
        <img src="img/sa.png" class="img-fluid mx-auto d-block" alt="..."> 
        <p class="text-center main-font font-weight-900 lh-1 text-uppercase">saudi arabia</p>
        <h1 class="text-center main-font font-weight-900 lh-1 text-white">19</h1>
        <p class="text-center main-font font-weight-900 lh-1 text-white text-uppercase pb-5">MAR</p>
      </div>
  
      <div class="col-md-2 darkcolor justify-content-center py-5 coleffect coleffectborder">
        <img src="img/australia.png" class="img-fluid mx-auto d-block" alt="...">
        <p class="text-center main-font font-weight-900 lh-1 text-uppercase">australia</p>
        <h1 class="text-center main-font font-weight-900 lh-1 text-white">02</h1>
        <p class="text-center main-font font-weight-900 lh-1 text-white text-uppercase pb-5">apr</p>
      </div>
  
      <div class="col-md-2 darkcolor justify-content-center py-5 coleffect coleffectborder">
        <img src="img/azerbaijan.png" class="img-fluid mx-auto d-block" alt="...">
        <p class="text-center main-font font-weight-900 lh-1 text-uppercase">azerbijan</p>
        <h1 class="text-center main-font font-weight-900 lh-1 text-white">30</h1>
        <p class="text-center main-font font-weight-900 lh-1 text-white text-uppercase pb-5">apr</p>
      </div>
    </div>
  </div>




    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.7/dist/umd/popper.min.js" integrity="sha384-zYPOMqeu1DAVkHiLqWBUTcbYfZ8osu1Nd6Z89ify25QV9guujx43ITvfi12/QExE" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.min.js" integrity="sha384-Y4oOpwW3duJdCWv5ly8SCFYWqFDsfob/3GkgExXKV4idmbt98QcxXYs9UoXAB7BZ" crossorigin="anonymous"></script>
</body>
<footer>


  <script>

    async function getPoints() {
		return await fetch("http://127.0.0.1/Formel1/Clientside/test.json")
			.then((response) => response.json())
			.then((data) => {return data})
    }


	const minLeft = 42;
	const maxLeft = 82;
	const numberOfPositions = 10;

	const pointList = document.querySelector(".pointList");


	function getCarPosition(position, highestScore) {
		const difference = maxLeft - minLeft;
		const incrementBy = difference / highestScore;
		return minLeft + incrementBy * position;
	}

	function getHighestScore(json) {
		let highestNumber = 0;
		json.forEach(x=> {
			if(x["score"] > highestNumber) {
				highestNumber = x["score"];
			}
		});
		return highestNumber;
	}


	// 42-82

	const timer = ms => new Promise(res => setTimeout(res, ms))
	async function makeCarAnimation() {
		const cars = document.querySelectorAll("img[data-left]")
		cars.forEach(async function(ele, index) {
			let dataLeft = ele.attributes["data-left"]["value"];
			for(let i = minLeft; i < parseInt(dataLeft.replace("%", "")); i++) {
				ele.style.left = i+ "%"
				await timer(10);
			}
		});
	}


	async function handleJson(json) {
		let num = numberOfPositions;
		let highestScore = getHighestScore(json);
		let data = json.map(function(score){
			let left = getCarPosition(score["score"], highestScore)
			num--;
			return`<div class="col-md-12 point-card overflow-hidden">
				<div class="px-2 pt-2 pb-2">
					<div class="row align-items-center position-relative height">
					<div class="col-md-1 text-center">
						<img src="img/redbull.png" class="img-fluid">
					</div>
					<div class="col-md-6">
						<div class="d-flex align-items-end gap-2">
						<h3 class="main-font font-weight-900 mb-0 text-uppercase">${score.name}</h3>
						<p class="main-font mb-0 font-weight-600 ">${score.team}</p>
						</div>
					</div>
					<div class="col-md-4 h-100">
						<img src="img/car.png" data-left="${left}%" class="z-999 img-fluid height-50px position-absolute top-50 transform formel-car">
					</div>
					<div class="col-md-1 backeffect">
						<h3 class="main-font z-999 position-relative font-weight-900 text-end formel-text ">${score["score"]}p</h3>
					</div>
					</div>
				</div>
				</div>
			`;
		});
		data = data.join("");
		pointList.innerHTML = data

	}



	function sortJson(json) {
		return json.sort(function(a, b) {return a.score - b.score}).reverse();
	}

	(async function() {
		let json = await getPoints();
		let sortedJson = sortJson(json);
		await handleJson(sortedJson);
		await makeCarAnimation();
	


	})();

	

    


  </script>

</footer>
  
</html>